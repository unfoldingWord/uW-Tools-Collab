# Bible Text Resource Container to Scripture Burrito Migration Guide

## Introduction

This guide provides specific instructions for migrating Bible text Resource Containers (UHB, UGNT, ULT, UST) to Scripture Burrito format. Bible text repositories are among the most straightforward to convert due to their standard USFM content.

**Applicable Repository Types:**
- **Original Language Texts**: UHB (Hebrew Bible), UGNT (Greek New Testament)
- **Gateway Language Translations**: ULT (Literal Translation), UST (Simplified Translation)

## Migration Overview

### Why Migrate Bible Text Repositories

**Benefits of Scripture Burrito for Bible Texts**:
- **Better Content Organization**: Explicit MIME type specification for USFM files
- **Enhanced Scope Precision**: Book-level scope definitions instead of simple categories
- **Improved Alignment Support**: Better handling of word alignment data
- **Cross-Tool Compatibility**: Works with broader ecosystem of Bible tools
- **Future-Proof Format**: Industry standard for Bible text interchange

### Migration Complexity

**Complexity Level**: ⭐ **Low** (easiest migration type)
**Data Loss**: ❌ **None** (all RC data preservable)
**Time Required**: 1-2 hours for automated conversion
**Manual Review**: Minimal (mainly validation)

## Pre-Migration Analysis

### Step 1: Analyze Source Repository

**Check Repository Characteristics**:
- Verify subject is "Bible" or "Aligned Bible"
- Confirm container type is "bundle"
- Count number of books (should be 66 for complete Bible)
- Note if alignment data is present (ULT/UST have alignment, UHB/UGNT don't)

**Expected File Structure**:
- manifest.yaml with dublin_core section
- 66+ USFM files (01-GEN.usfm through 67-REV.usfm or similar)
- Possible front matter file (A0-FRT.usfm)
- LICENSE.md file

### Step 2: Determine Target Scripture Burrito Flavor

**Flavor Selection**:
- **All Bible text repositories** → Scripture flavor type: `textTranslation`
- **Flavor characteristics**: Main content with book-level scope
- **Ingredient roles**: All USFM files will be "main" role

## Migration Steps

### Step 1: Create Scripture Burrito Metadata Structure

**Base Metadata Template**:
```json
{
  "meta": {
    "format": "scripture burrito",
    "version": "0.3.0",
    "generator": {
      "softwareName": "RC to SB Converter",
      "softwareVersion": "1.0.0"
    }
  },
  "identification": {
    "name": "{RC dublin_core.title}",
    "abbreviation": "{RC dublin_core.identifier}",
    "description": "{RC dublin_core.description}",
    "version": "{RC dublin_core.version}"
  },
  "languages": [
    {
      "tag": "{RC dublin_core.language.identifier}",
      "name": "{Human readable language name}",
      "direction": "{RC dublin_core.language.direction}"
    }
  ],
  "type": {
    "flavorType": {
      "name": "textTranslation",
      "currentScope": {
        "book": ["{List of book codes}"]
      }
    }
  }
}
```

### Step 2: Convert Projects to Ingredients

**For Each Project in RC projects[] Array**:

**Create Ingredient Entry**:
- **Key**: Use project path without "./" prefix (e.g., "01-GEN.usfm")
- **mimeType**: "text/usfm" for all USFM files
- **role**: "main" for Bible books, "introduction" for front matter
- **scope**: `{"book": "{project.identifier.toUpperCase()}"}` (e.g., {"book": "GEN"})

**Example Ingredient**:
```json
"01-GEN.usfm": {
  "mimeType": "text/usfm",
  "role": "main",
  "scope": {
    "book": "GEN"
  }
}
```

### Step 3: Handle Dependencies and Relationships

**Convert RC relation[] to SB relationships[]**:
- Each RC relation becomes an SB relationship
- Map relation format "lang/resource" to SB relationship format
- Preserve version specifications (e.g., "hbo/uhb?v=2.1.30")

**Example Relationships**:
```json
"relationships": [
  {
    "type": "source",
    "flavor": "textTranslation",
    "id": "hbo_uhb",
    "version": "2.1.30"
  },
  {
    "type": "related",
    "flavor": "parascripturalWordAlignment", 
    "id": "en_tn"
  }
]
```

### Step 4: Preserve RC-Specific Metadata

**Handle RC Checking Information**:
```json
"meta": {
  "format": "scripture burrito",
  "version": "0.3.0",
  "generator": {
    "softwareName": "RC to SB Converter",
    "rcCheckingLevel": "{RC checking.checking_level}",
    "rcCheckingEntity": "{RC checking.checking_entity}"
  }
}
```

**Handle RC Contributors**:
```json
"agencies": [
  {
    "id": "unfoldingWord",
    "name": "{RC dublin_core.publisher}",
    "roles": ["publisher"],
    "contributors": "{RC dublin_core.contributor array}"
  }
]
```

## Migration Examples

### Example 1: English ULT Migration

**Source RC Manifest** (manifest.yaml):
```yaml
dublin_core:
  identifier: 'ult'
  title: 'unfoldingWord® Literal Text'
  language:
    identifier: 'en'
    direction: 'ltr'
  subject: 'Aligned Bible'
  type: 'bundle'
  version: '86'
  relation:
    - 'en/tw'
    - 'hbo/uhb?v=2.1.30'

projects:
  - identifier: 'gen'
    title: 'Genesis'
    path: './01-GEN.usfm'
    sort: 1
    categories: ['bible-ot']
```

**Converted SB Metadata** (metadata.json):
```json
{
  "meta": {
    "format": "scripture burrito",
    "version": "0.3.0"
  },
  "identification": {
    "name": "unfoldingWord® Literal Text",
    "abbreviation": "ULT",
    "version": "86"
  },
  "languages": [
    {
      "tag": "en",
      "name": "English",
      "direction": "ltr"
    }
  ],
  "type": {
    "flavorType": {
      "name": "textTranslation",
      "currentScope": {
        "book": ["GEN"]
      }
    }
  },
  "ingredients": {
    "01-GEN.usfm": {
      "mimeType": "text/usfm",
      "role": "main",
      "scope": {
        "book": "GEN"
      }
    }
  },
  "relationships": [
    {
      "type": "related",
      "flavor": "glossary",
      "id": "en_tw"
    },
    {
      "type": "source", 
      "flavor": "textTranslation",
      "id": "hbo_uhb",
      "version": "2.1.30"
    }
  ]
}
```

### Example 2: Hebrew Bible Migration

**Source RC** (hbo_uhb):
- Subject: "Bible" (original language)
- No alignment data
- Right-to-left text direction

**Converted SB Metadata**:
```json
{
  "identification": {
    "name": "unfoldingWord® Hebrew Bible",
    "abbreviation": "UHB"
  },
  "languages": [
    {
      "tag": "hbo",
      "name": "Ancient Hebrew",
      "direction": "rtl"
    }
  ],
  "type": {
    "flavorType": {
      "name": "textTranslation"
    }
  }
}
```

## Migration Validation

### Step 1: Validate Scripture Burrito Structure

**Required Validations**:
- Confirm metadata.json follows SB schema
- Verify all ingredients have required fields (mimeType, role, scope)
- Check that flavor type is appropriate
- Validate language information

### Step 2: Validate Content Integrity

**Content Checks**:
- Verify all USFM files are properly referenced in ingredients
- Confirm file paths match ingredient keys
- Check that scope objects correctly identify book content

### Step 3: Test with Scripture Burrito Tools

**Compatibility Testing**:
- Load converted SB into SB-compatible applications
- Verify content displays correctly
- Test cross-references and relationships work

## Best Practices for Bible Text Migration

### 1. Batch Processing
- Convert all books in a repository together
- Maintain book order and relationships
- Preserve alignment data integrity

### 2. Scope Precision
- Use precise book codes in scope objects
- Handle front matter appropriately (introduction role)
- Maintain testament categorization if needed

### 3. Alignment Preservation
- Ensure USFM alignment markers are preserved exactly
- Maintain word-level alignment integrity
- Preserve Strong's numbers and morphology data

### 4. Relationship Mapping
- Convert all RC relations to SB relationships
- Preserve version specifications
- Maintain dependency hierarchies

## Migration Checklist

### Pre-Migration
- [ ] Analyze source RC repository structure
- [ ] Verify all required files are present
- [ ] Check for any non-standard RC elements
- [ ] Plan ingredient organization

### During Migration
- [ ] Create SB metadata.json from RC manifest.yaml
- [ ] Convert all projects to ingredients
- [ ] Map RC relations to SB relationships
- [ ] Preserve RC-specific metadata in extensions

### Post-Migration
- [ ] Validate SB metadata against schema
- [ ] Verify all content files are referenced
- [ ] Test with SB-compatible tools
- [ ] Document any conversion decisions

## Common Migration Issues

### Issue 1: Large File Handling
**Problem**: Some Bible books are very large with alignment data
**Solution**: SB handles large files same as RC - no special handling needed

### Issue 2: Versification Differences
**Problem**: RC versification vs SB scope format
**Solution**: SB scope is more flexible - can include versification info

### Issue 3: Alignment Data Complexity
**Problem**: Word alignment markers in USFM
**Solution**: SB preserves USFM exactly - no changes needed to alignment

---

This migration guide is based on analysis of Bible text Resource Containers and [Scripture Burrito specification](https://docs.burrito.bible/) research, and should be used alongside the main [RC to Scripture Burrito Conversion Guide](../rc-to-scripture-burrito-conversion-guide.md).
